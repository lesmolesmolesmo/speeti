import{c as h,u as Qe,b as Xe,r as x,g as u,j as e,P as I,S as Je,q as ue,s as Ye,t as J,G as ke,T as Y,H as ee,p as pe,v as es,A as he,h as Q,B as ss,l as ge,M as ts,m as O,X as be,w as as,x as ls,U as rs}from"./index-TnPH2S_w.js";import{P as U}from"./package-DJqEn-u_.js";import{S as ns,L as is}from"./settings-BXha7_KE.js";import{D as os}from"./download-BWAFhTqI.js";import{T as ds}from"./tag-DZDAfEXw.js";import{B as cs}from"./bot-kVKhgGDd.js";import{S as xs}from"./send-CWO-Q0mc.js";import{M as ms}from"./message-circle-DwikqqP-.js";/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=h("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=h("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=h("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=h("Barcode",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=h("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=h("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=h("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=h("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=h("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=h("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=h("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=h("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=h("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=h("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=h("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=h("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=h("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=h("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]),we=[{id:"dashboard",label:"Dashboard",icon:Ye},{id:"orders",label:"Bestellungen",icon:J,badge:!0},{id:"products",label:"Produkte",icon:U},{id:"categories",label:"Kategorien",icon:ke},{id:"warehouse",label:"Lager",icon:ws,external:"/warehouse"},{id:"drivers",label:"Fahrer",icon:Y},{id:"customers",label:"Kunden",icon:Ce},{id:"support",label:"Support",icon:ee,supportBadge:!0},{id:"analytics",label:"Statistiken",icon:hs},{id:"settings",label:"Einstellungen",icon:ns}],M={pending:{label:"Neu",color:"yellow",bg:"bg-yellow-100",text:"text-yellow-700"},confirmed:{label:"Best√§tigt",color:"blue",bg:"bg-blue-100",text:"text-blue-700"},picking:{label:"Wird gepackt",color:"indigo",bg:"bg-indigo-100",text:"text-indigo-700"},picked:{label:"Gepackt",color:"purple",bg:"bg-purple-100",text:"text-purple-700"},delivering:{label:"Unterwegs",color:"primary",bg:"bg-primary-100",text:"text-primary-700"},delivered:{label:"Geliefert",color:"green",bg:"bg-green-100",text:"text-green-700"},cancelled:{label:"Storniert",color:"red",bg:"bg-red-100",text:"text-red-700"}};function Ps(){const F=Qe(),{user:H,logout:se}=Xe(),[f,P]=x.useState("dashboard"),[T,Se]=x.useState({}),[C,_e]=x.useState([]),[A,ze]=x.useState([]),[D,Me]=x.useState([]),[te,Be]=x.useState([]),[G,g]=x.useState(null),[v,w]=x.useState(null),[V,$e]=x.useState(""),[d,L]=x.useState(null),[B,ae]=x.useState("all"),[S,ks]=x.useState(!1),[W,Fe]=x.useState([]),[b,le]=x.useState(null),[Pe,Te]=x.useState([]),[E,re]=x.useState(""),[ne,ie]=x.useState({name:"",description:"",price:"",original_price:"",category_id:"",unit:"St√ºck",unit_amount:"1",image:"",sku:"",ean:"",weight:"",weight_unit:"g",stock_count:100,min_order:1,max_order:99,tax_rate:19,deposit:0,storage_temp:"",allergens:"",ingredients:"",nutrition_info:"",origin:"",brand:"",featured:!1,in_stock:!0,visible:!0}),[Ae,oe]=x.useState("basic"),[de,ce]=x.useState(!1);x.useEffect(()=>{if(!H||H.role!=="admin"){F("/login?redirect=/admin");return}y();const s=setInterval(y,3e4);return()=>clearInterval(s)},[H]);const y=async()=>{try{const[s,t,n,i,c,r]=await Promise.all([u.get("/admin/stats"),u.get("/orders"),u.get("/products"),u.get("/categories"),u.get("/admin/users"),u.get("/admin/support").catch(()=>({data:[]}))]);Se(s.data),_e(t.data),ze(n.data),Me(i.data),Be(c.data),Fe(r.data)}catch(s){console.error(s)}},xe=C.filter(s=>["pending","confirmed","picking"].includes(s.status)).length,R=W.filter(s=>s.escalated&&s.status==="open").length,De=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-teal-500 rounded-2xl p-6 text-white",children:[e.jsx("h1",{className:"text-2xl font-bold mb-1",children:"Willkommen zur√ºck! "}),e.jsx("p",{className:"text-white/80",children:"Hier ist dein √úberblick f√ºr heute."})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(q,{icon:J,label:"Bestellungen heute",value:T.orders_today||0,trend:"+12%",trendUp:!0}),e.jsx(q,{icon:fe,label:"Umsatz heute",value:`${(T.revenue_today||0).toFixed(2)}‚Ç¨`,trend:"+8%",trendUp:!0}),e.jsx(q,{icon:he,label:"Offene Bestellungen",value:T.pending_orders||0,highlight:!0}),e.jsx(q,{icon:Ce,label:"Neue Kunden",value:T.total_customers||0,trend:"+5%",trendUp:!0})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("h3",{className:"font-semibold",children:"Live Bestellungen"})]}),e.jsx("button",{onClick:()=>P("orders"),className:"text-primary-600 text-sm font-medium",children:"Alle anzeigen ‚Üí"})]}),e.jsxs("div",{className:"divide-y divide-gray-100",children:[C.filter(s=>s.status!=="delivered"&&s.status!=="cancelled").slice(0,5).map(s=>e.jsx(me,{order:s,compact:!0,onClick:()=>{L(s),P("orders")}},s.id)),C.filter(s=>s.status!=="delivered").length===0&&e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(Q,{size:40,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Keine offenen Bestellungen"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(K,{icon:I,label:"Neues Produkt",onClick:()=>{var s;w(null),ie({name:"",description:"",price:"",original_price:"",category_id:((s=D[0])==null?void 0:s.id)||"",unit:"St√ºck",unit_amount:"1",image:"",sku:"",ean:"",weight:"",weight_unit:"g",stock_count:100,min_order:1,max_order:99,tax_rate:19,deposit:0,storage_temp:"",allergens:"",ingredients:"",nutrition_info:"",origin:"",brand:"",featured:!1,in_stock:!0,visible:!0}),oe("basic"),g("product")}}),e.jsx(K,{icon:Y,label:"Neuer Fahrer",onClick:()=>{w(null),g("driver")}}),e.jsx(K,{icon:ke,label:"Neue Kategorie",onClick:()=>{w(null),g("category")}}),e.jsx(K,{icon:os,label:"Bericht exportieren"})]})]}),q=({icon:s,label:t,value:n,trend:i,trendUp:c,highlight:r})=>e.jsxs("div",{className:`rounded-2xl p-5 ${r?"bg-yellow-50 border-2 border-yellow-200":"bg-white shadow-sm"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${r?"bg-yellow-200":"bg-gray-100"}`,children:e.jsx(s,{size:20,className:r?"text-yellow-700":"text-gray-600"})}),i&&e.jsxs("span",{className:`text-xs font-semibold flex items-center gap-1 ${c?"text-green-600":"text-red-600"}`,children:[c?e.jsx(ps,{size:14}):e.jsx(us,{size:14}),i]})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n}),e.jsx("p",{className:"text-sm text-gray-500",children:t})]}),K=({icon:s,label:t,onClick:n})=>e.jsxs("button",{onClick:n,className:"bg-white rounded-xl p-4 shadow-sm hover:shadow-md transition-all flex items-center gap-3 text-left",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:e.jsx(s,{size:20,className:"text-primary-600"})}),e.jsx("span",{className:"font-medium text-sm text-gray-700",children:t})]}),me=({order:s,compact:t,onClick:n})=>{var c,r;const i=M[s.status]||M.pending;return e.jsx("div",{onClick:n,className:`p-4 hover:bg-gray-50 cursor-pointer transition-colors ${t?"":"border-b border-gray-100"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-bold text-gray-900",children:["#",s.id]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${i.bg} ${i.text}`,children:i.label}),s.status==="pending"&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-yellow-600 bg-yellow-50 px-2 py-0.5 rounded-full",children:[e.jsx(ss,{size:10})," Neu!"]})]}),e.jsx("p",{className:"font-medium text-gray-800",children:s.customer_name}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ge,{size:12})," ",s.customer_phone||"Keine Nr."]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(U,{size:12})," ",((c=s.items)==null?void 0:c.length)||0," Artikel"]})]}),e.jsxs("div",{className:"flex items-start gap-1 mt-2 text-sm text-gray-600 bg-gray-50 rounded-lg p-2",children:[e.jsx(ts,{size:14,className:"text-primary-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[s.street," ",s.house_number]}),e.jsxs("p",{children:[s.postal_code," ",s.city]}),s.instructions&&e.jsxs("p",{className:"text-xs text-primary-600 mt-1",children:["üìù ",s.instructions]})]})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("p",{className:"font-bold text-lg text-gray-900",children:[(r=s.total)==null?void 0:r.toFixed(2),"‚Ç¨"]}),e.jsxs("p",{className:"text-xs text-gray-400",children:[new Date(s.created_at).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})," Uhr"]})]})]})})},Le=()=>{const s=C.filter(t=>B==="all"||t.status===B);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Bestellungen"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[C.length," Bestellungen insgesamt"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:y,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(je,{size:18})}),e.jsxs("select",{value:B,onChange:t=>ae(t.target.value),className:"px-3 py-2 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:"Alle Status"}),Object.entries(M).map(([t,n])=>e.jsx("option",{value:t,children:n.label},t))]})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:Object.entries(M).map(([t,n])=>{const i=C.filter(c=>c.status===t).length;return e.jsxs("button",{onClick:()=>ae(t===B?"all":t),className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium transition-all ${B===t?`${n.bg} ${n.text}`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[n.label,e.jsx("span",{className:"bg-white/50 px-1.5 rounded-full text-xs",children:i})]},t)})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:s.length===0?e.jsxs("div",{className:"p-12 text-center text-gray-400",children:[e.jsx(J,{size:48,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Keine Bestellungen gefunden"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:s.map(t=>e.jsxs("div",{className:"p-4 hover:bg-gray-50",children:[e.jsx(me,{order:t,onClick:()=>L(t)}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t border-gray-100",children:[e.jsx("select",{value:t.status,onChange:async n=>{await u.patch(`/orders/${t.id}/status`,{status:n.target.value}),y()},className:"px-3 py-1.5 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:Object.entries(M).map(([n,i])=>e.jsx("option",{value:n,children:i.label},n))}),e.jsx("button",{onClick:()=>L(t),className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500",title:"Details & Drucken",children:e.jsx(ye,{size:16})}),e.jsx("button",{onClick:()=>{const n=`${t.street} ${t.house_number}, ${t.postal_code} ${t.city}`;navigator.clipboard.writeText(n)},className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500",title:"Adresse kopieren",children:e.jsx(fs,{size:16})}),e.jsx("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(`${t.street} ${t.house_number}, ${t.postal_code} ${t.city}`)}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500",title:"In Maps √∂ffnen",children:e.jsx(X,{size:16})})]})]},t.id))})})]})},Ee=x.useMemo(()=>A.filter(s=>s.name.toLowerCase().includes(V.toLowerCase())),[A,V]),Re=e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Produkte"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[A.length," Produkte im Sortiment"]})]}),e.jsxs("button",{onClick:()=>{w(null),g("product")},className:"flex items-center gap-2 bg-primary-500 text-white px-4 py-2 rounded-xl hover:bg-primary-600 transition-colors",children:[e.jsx(I,{size:20})," Neues Produkt"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Je,{size:20,className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Produkt suchen...",value:V,onChange:s=>$e(s.target.value),className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Produkt"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Kategorie"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Preis"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Bestand"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase",children:"Aktionen"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:Ee.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden",children:s.image?e.jsx("img",{src:s.image,alt:"",className:"w-full h-full object-cover"}):e.jsx(U,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.unit_amount," ",s.unit]})]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:s.category_name}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-gray-900",children:[s.price.toFixed(2),"‚Ç¨"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.stock_count||"‚àû"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${s.in_stock?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:s.in_stock?"Verf√ºgbar":"Ausverkauft"})}),e.jsxs("td",{className:"px-4 py-3 text-right",children:[e.jsx("button",{onClick:()=>{w(s),g("product")},className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500",children:e.jsx(vs,{size:16})}),e.jsx("button",{onClick:async()=>{confirm("L√∂schen?")&&(await u.delete(`/admin/products/${s.id}`),y())},className:"p-2 hover:bg-red-50 rounded-lg text-red-500",children:e.jsx(ue,{size:16})})]})]},s.id))})]})})]}),qe=()=>{const s=v||ne,t=a=>{v?w(a):ie(typeof a=="function"?a(ne):a)},n=Ae,i=oe,c=async()=>{var a,j,k,_;if(!s.name||s.name.length<3){alert("Bitte gib zuerst einen Produktnamen ein (min. 3 Zeichen)");return}ce(!0);try{const z=await(await fetch(`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(s.name)}&search_simple=1&action=process&json=1&page_size=5`)).json();if(z.products&&z.products.length>0){const m=z.products[0];t({...s,description:m.generic_name_de||m.generic_name||m.product_name_de||s.description||"",brand:m.brands||s.brand||"",ean:m.code||s.ean||"",weight:m.quantity?m.quantity.replace(/[^0-9]/g,""):s.weight||"",weight_unit:(a=m.quantity)!=null&&a.includes("ml")?"ml":(j=m.quantity)!=null&&j.includes("l")?"l":"g",ingredients:m.ingredients_text_de||m.ingredients_text||s.ingredients||"",allergens:m.allergens_tags?m.allergens_tags.map(Z=>Z.replace("en:","")).join(", "):s.allergens||"",nutrition_info:m.nutriments?`Energie: ${m.nutriments["energy-kcal_100g"]||"?"} kcal, Fett: ${m.nutriments.fat_100g||"?"}g, Kohlenhydrate: ${m.nutriments.carbohydrates_100g||"?"}g, Zucker: ${m.nutriments.sugars_100g||"?"}g, Eiwei√ü: ${m.nutriments.proteins_100g||"?"}g, Salz: ${m.nutriments.salt_100g||"?"}g`:s.nutrition_info||"",origin:m.origins||((_=(k=m.countries_tags)==null?void 0:k[0])==null?void 0:_.replace("en:",""))||s.origin||""}),alert("‚úÖ Produktdaten gefunden und eingef√ºgt! Bitte pr√ºfen und ggf. anpassen.")}else alert("‚ùå Kein Produkt gefunden. Versuche einen anderen Namen oder f√ºlle manuell aus.")}catch($){console.error("Auto-fill error:",$),alert("‚ùå Fehler beim Abrufen der Produktdaten. Bitte manuell ausf√ºllen.")}finally{ce(!1)}},r=[{id:"basic",label:"Basis",icon:js},{id:"pricing",label:"Preise",icon:ds},{id:"inventory",label:"Bestand",icon:bs},{id:"details",label:"Details",icon:gs},{id:"nutrition",label:"N√§hrwerte",icon:Ne}],o=async a=>{a.preventDefault();const j={...s,price:parseFloat(s.price),original_price:s.original_price?parseFloat(s.original_price):null};v?await u.put(`/admin/products/${v.id}`,j):await u.post("/admin/products",j),g(null),y()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(O.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold",children:v?"Produkt bearbeiten":"Neues Produkt anlegen"}),e.jsx("p",{className:"text-sm text-gray-500",children:"F√ºlle alle relevanten Felder aus"})]}),e.jsx("button",{onClick:()=>g(null),className:"p-2 hover:bg-gray-200 rounded-full",children:e.jsx(be,{size:20})})]}),e.jsx("div",{className:"flex border-b border-gray-200 px-4 bg-white",children:r.map(a=>e.jsxs("button",{onClick:()=>i(a.id),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${n===a.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(a.icon,{size:16}),a.label]},a.id))}),e.jsxs("form",{onSubmit:o,className:"flex-1 overflow-y-auto p-6",children:[n==="basic"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Produktname *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:s.name,onChange:a=>t({...s,name:a.target.value}),required:!0,className:"flex-1 px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"z.B. HARIBO Goldb√§ren 175g"}),e.jsx("button",{type:"button",onClick:c,disabled:de||!s.name||s.name.length<3,className:"px-4 py-2.5 bg-gradient-to-r from-violet-500 to-purple-600 text-white rounded-xl font-medium hover:from-violet-600 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 whitespace-nowrap",title:"Produktdaten automatisch aus Open Food Facts laden",children:de?e.jsxs(e.Fragment,{children:[e.jsx(is,{size:18,className:"animate-spin"})," Suche..."]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{size:18})," Auto-Fill"]})})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'üí° Tipp: Gib den vollen Produktnamen ein und klicke "Auto-Fill" f√ºr automatische Daten'})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Beschreibung"}),e.jsx("textarea",{value:s.description||"",onChange:a=>t({...s,description:a.target.value}),rows:3,className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Produktbeschreibung f√ºr Kunden..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategorie *"}),e.jsx("select",{value:s.category_id,onChange:a=>t({...s,category_id:parseInt(a.target.value)}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",children:D.map(a=>e.jsxs("option",{value:a.id,children:[a.icon," ",a.name]},a.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marke"}),e.jsx("input",{type:"text",value:s.brand||"",onChange:a=>t({...s,brand:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"z.B. Weihenstephan"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Produktbild"}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx("div",{className:"w-24 h-24 border-2 border-dashed border-gray-300 rounded-xl overflow-hidden flex items-center justify-center bg-gray-50",children:s.image?e.jsx("img",{src:s.image,alt:"",className:"w-full h-full object-cover"}):e.jsx(ys,{size:32,className:"text-gray-300"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2.5 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx(Ns,{size:18,className:"text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Bild hochladen"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:async a=>{const j=a.target.files[0];if(!j)return;const k=new FormData;k.append("image",j);try{const _=await u.post("/upload/product",k,{headers:{"Content-Type":"multipart/form-data"}});t({...s,image:_.data.url})}catch{alert("Upload fehlgeschlagen")}}})]}),e.jsx("input",{type:"url",value:s.image||"",onChange:a=>t({...s,image:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm",placeholder:"oder URL eingeben: https://..."}),s.image&&e.jsx("button",{type:"button",onClick:()=>t({...s,image:""}),className:"text-xs text-red-500 hover:underline",children:"Bild entfernen"})]})]})]})]})}),n==="pricing"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verkaufspreis (‚Ç¨) *"}),e.jsx("input",{type:"number",step:"0.01",value:s.price,onChange:a=>t({...s,price:a.target.value}),required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Streichpreis (‚Ç¨)"}),e.jsx("input",{type:"number",step:"0.01",value:s.original_price||"",onChange:a=>t({...s,original_price:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Alter Preis f√ºr Rabatt-Anzeige"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"MwSt. (%)"}),e.jsxs("select",{value:s.tax_rate,onChange:a=>t({...s,tax_rate:parseInt(a.target.value)}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:19,children:"19% (Standard)"}),e.jsx("option",{value:7,children:"7% (Erm√§√üigt)"}),e.jsx("option",{value:0,children:"0% (Steuerfrei)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pfand (‚Ç¨)"}),e.jsx("input",{type:"number",step:"0.01",value:s.deposit||"",onChange:a=>t({...s,deposit:parseFloat(a.target.value)||0}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"0.00"})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 rounded-xl",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"üí° Tipp:"})," Setze einen Streichpreis um Rabatte anzuzeigen. Der Rabatt wird automatisch berechnet."]})})]}),n==="inventory"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Einheit"}),e.jsxs("select",{value:s.unit,onChange:a=>t({...s,unit:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"St√ºck",children:"St√ºck"}),e.jsx("option",{value:"kg",children:"Kilogramm (kg)"}),e.jsx("option",{value:"g",children:"Gramm (g)"}),e.jsx("option",{value:"L",children:"Liter (L)"}),e.jsx("option",{value:"ml",children:"Milliliter (ml)"}),e.jsx("option",{value:"Bund",children:"Bund"}),e.jsx("option",{value:"Packung",children:"Packung"}),e.jsx("option",{value:"Flasche",children:"Flasche"}),e.jsx("option",{value:"Dose",children:"Dose"}),e.jsx("option",{value:"Glas",children:"Glas"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Menge pro Einheit"}),e.jsx("input",{type:"text",value:s.unit_amount,onChange:a=>t({...s,unit_amount:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"z.B. 500, 1, 6x0.33"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lagerbestand"}),e.jsx("input",{type:"number",value:s.stock_count,onChange:a=>t({...s,stock_count:parseInt(a.target.value)}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mindestbestellmenge"}),e.jsx("input",{type:"number",value:s.min_order,onChange:a=>t({...s,min_order:parseInt(a.target.value)}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Maximalbestellmenge"}),e.jsx("input",{type:"number",value:s.max_order,onChange:a=>t({...s,max_order:parseInt(a.target.value)}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lagertemperatur"}),e.jsxs("select",{value:s.storage_temp||"",onChange:a=>t({...s,storage_temp:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Normal"}),e.jsx("option",{value:"k√ºhl",children:"K√ºhlware (2-7¬∞C)"}),e.jsx("option",{value:"tiefk√ºhl",children:"Tiefk√ºhl (-18¬∞C)"})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.in_stock,onChange:a=>t({...s,in_stock:a.target.checked}),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Auf Lager"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.featured,onChange:a=>t({...s,featured:a.target.checked}),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:'Als "Beliebt" anzeigen'})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.visible!==!1,onChange:a=>t({...s,visible:a.target.checked}),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Sichtbar im Shop"})]})]})]}),n==="details"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU / Artikelnummer"}),e.jsx("input",{type:"text",value:s.sku||"",onChange:a=>t({...s,sku:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"z.B. MILK-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EAN / Barcode"}),e.jsx("input",{type:"text",value:s.ean||"",onChange:a=>t({...s,ean:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"z.B. 4012345678901"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gewicht"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",value:s.weight||"",onChange:a=>t({...s,weight:a.target.value}),className:"flex-1 px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"0"}),e.jsxs("select",{value:s.weight_unit,onChange:a=>t({...s,weight_unit:a.target.value}),className:"px-3 py-2.5 border border-gray-200 rounded-xl",children:[e.jsx("option",{value:"g",children:"g"}),e.jsx("option",{value:"kg",children:"kg"}),e.jsx("option",{value:"ml",children:"ml"}),e.jsx("option",{value:"L",children:"L"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Herkunft"}),e.jsx("input",{type:"text",value:s.origin||"",onChange:a=>t({...s,origin:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"z.B. Deutschland, Bayern"})]})]})}),n==="nutrition"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Zutaten"}),e.jsx("textarea",{value:s.ingredients||"",onChange:a=>t({...s,ingredients:a.target.value}),rows:3,className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Vollst√§ndige Zutatenliste..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allergene"}),e.jsx("input",{type:"text",value:s.allergens||"",onChange:a=>t({...s,allergens:a.target.value}),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"z.B. Milch, Gluten, N√ºsse"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N√§hrwerte (pro 100g/ml)"}),e.jsx("textarea",{value:s.nutrition_info||"",onChange:a=>t({...s,nutrition_info:a.target.value}),rows:4,className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:`Brennwert: 250 kJ / 60 kcal
Fett: 3,5 g
Kohlenhydrate: 4,8 g
Eiwei√ü: 3,3 g`})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex items-center justify-between",children:[e.jsx("button",{type:"button",onClick:()=>g(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-200 rounded-xl",children:"Abbrechen"}),e.jsxs("button",{onClick:o,className:"px-6 py-2 bg-primary-500 text-white rounded-xl hover:bg-primary-600 flex items-center gap-2",children:[e.jsx(ve,{size:18})," ",v?"Speichern":"Produkt anlegen"]})]})]})})},Ke=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Kategorien (",D.length,")"]}),e.jsxs("button",{onClick:()=>{w(null),g("category")},className:"flex items-center gap-2 bg-primary-500 text-white px-4 py-2 rounded-xl hover:bg-primary-600",children:[e.jsx(I,{size:20})," Neue Kategorie"]})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.map(s=>e.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:s.color+"20"},children:s.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["/",s.slug]}),e.jsxs("p",{className:"text-xs text-gray-400",children:[A.filter(t=>t.category_id===s.id).length," Produkte"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{w(s),g("category")},className:"flex-1 py-2 border border-gray-200 rounded-xl text-sm hover:bg-gray-50",children:"Bearbeiten"}),e.jsx("button",{onClick:async()=>{confirm("L√∂schen?")&&(await u.delete(`/admin/categories/${s.id}`),y())},className:"px-4 py-2 border border-red-200 text-red-500 rounded-xl hover:bg-red-50",children:e.jsx(ue,{size:14})})]})]},s.id))})]}),Ie=()=>{const s=te.filter(t=>t.role==="driver");return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Fahrer (",s.length,")"]}),e.jsxs("button",{onClick:()=>{w(null),g("driver")},className:"flex items-center gap-2 bg-primary-500 text-white px-4 py-2 rounded-xl hover:bg-primary-600",children:[e.jsx(I,{size:20})," Neuer Fahrer"]})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(t=>e.jsx("div",{className:"bg-white rounded-2xl p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(Y,{className:"text-primary-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500",children:t.email}),e.jsx("p",{className:"text-sm text-gray-500",children:t.phone})]})]})},t.id))})]})},Oe=()=>{const s=te.filter(t=>t.role==="customer");return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Kunden (",s.length,")"]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Kunde"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Kontakt"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Registriert"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Bestellungen"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:s.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:t.name}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-600",children:[e.jsx("p",{children:t.email}),e.jsx("p",{className:"text-gray-400",children:t.phone||"-"})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString("de-DE")}),e.jsx("td",{className:"px-4 py-3 text-sm",children:C.filter(n=>n.user_id===t.id).length})]},t.id))})]})})]})},Ue=()=>{const[s,t]=x.useState(null),[n,i]=x.useState(!1),[c,r]=x.useState({openingTime:"08:00",closingTime:"22:00"}),[o,a]=x.useState({shopName:"Speeti",slogan:"Blitzschnell bei dir",deliveryFee:"2.99",freeDeliveryMin:"20",minOrder:"10",deliveryTime:"15-20",hours:"08:00-22:00",area:"M√ºnster",companyName:"",companyStreet:"",companyCity:"",companyPostalCode:"",companyPhone:"",companyEmail:"",companyWebsite:"",taxNumber:"",vatId:"",taxRateFood:"7",taxRateOther:"19",bankName:"",iban:"",bic:""}),[j,k]=x.useState(!1),[_,$]=x.useState(!1);x.useEffect(()=>{u.get("/admin/settings").then(({data:l})=>{l&&a(N=>({...N,...l}))}).catch(()=>{}),u.get("/shop/status").then(({data:l})=>{t(l.open),r({openingTime:l.openingTime,closingTime:l.closingTime})}).catch(()=>{})},[]);const z=async l=>{i(!0);try{const{data:N}=await u.post("/admin/shop/toggle",{action:l});t(N.open)}catch{alert("Fehler beim √Ñndern des Shop-Status")}finally{i(!1)}},m=async()=>{try{await u.put("/admin/shop/hours",c),alert("√ñffnungszeiten gespeichert!")}catch{alert("Fehler beim Speichern")}},Z=async()=>{k(!0);try{await u.post("/admin/settings",o),$(!0),setTimeout(()=>$(!1),2e3)}catch{alert("Fehler beim Speichern")}finally{k(!1)}},p=(l,N)=>{a(Ze=>({...Ze,[l]:N}))};return e.jsxs("div",{className:"max-w-3xl space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Einstellungen"}),_&&e.jsxs("span",{className:"text-green-600 font-medium flex items-center gap-2",children:[e.jsx(Q,{size:18})," Gespeichert!"]})]}),e.jsxs("div",{className:`rounded-2xl p-6 shadow-sm space-y-4 ${s?"bg-green-50 border-2 border-green-200":"bg-amber-50 border-2 border-amber-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${s?"bg-green-500 animate-pulse":"bg-amber-500"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s?"üü¢ Shop ist GE√ñFFNET":"üü° Shop ist GESCHLOSSEN"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["√ñffnungszeiten: ",c.openingTime," - ",c.closingTime," Uhr"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z("open"),disabled:n||s===!0,className:`px-4 py-2 rounded-xl font-medium transition-colors ${s?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"}`,children:"√ñffnen"}),e.jsx("button",{onClick:()=>z("close"),disabled:n||s===!1,className:`px-4 py-2 rounded-xl font-medium transition-colors ${s?"bg-amber-500 text-white hover:bg-amber-600":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:"Schlie√üen"}),e.jsx("button",{onClick:()=>z("auto"),disabled:n,className:"px-4 py-2 rounded-xl font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors",children:"Auto"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-2 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"√ñffnet:"}),e.jsx("input",{type:"time",value:c.openingTime,onChange:l=>r(N=>({...N,openingTime:l.target.value})),className:"px-3 py-1.5 border rounded-lg text-sm"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Schlie√üt:"}),e.jsx("input",{type:"time",value:c.closingTime,onChange:l=>r(N=>({...N,closingTime:l.target.value})),className:"px-3 py-1.5 border rounded-lg text-sm"})]}),e.jsx("button",{onClick:m,className:"px-4 py-1.5 bg-rose-500 text-white rounded-lg text-sm font-medium hover:bg-rose-600",children:"Speichern"})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["üí° ",e.jsx("strong",{children:"Auto:"})," Folgt den √ñffnungszeiten automatisch ¬∑",e.jsx("strong",{children:"√ñffnen/Schlie√üen:"})," Manuell √ºberschreiben (z.B. f√ºr Feiertage oder l√§ngere √ñffnung)"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"font-semibold border-b pb-2 flex items-center gap-2",children:[e.jsx(U,{size:18,className:"text-rose-500"})," Shop-Einstellungen"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Shop-Name"}),e.jsx("input",{type:"text",value:o.shopName,onChange:l=>p("shopName",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Slogan"}),e.jsx("input",{type:"text",value:o.slogan,onChange:l=>p("slogan",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Liefergeb√ºhr (‚Ç¨)"}),e.jsx("input",{type:"number",value:o.deliveryFee,step:"0.01",onChange:l=>p("deliveryFee",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gratis ab (‚Ç¨)"}),e.jsx("input",{type:"number",value:o.freeDeliveryMin,onChange:l=>p("freeDeliveryMin",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Mindestbestellwert (‚Ç¨)"}),e.jsx("input",{type:"number",value:o.minOrder,onChange:l=>p("minOrder",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lieferzeit (Min)"}),e.jsx("input",{type:"text",value:o.deliveryTime,onChange:l=>p("deliveryTime",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"√ñffnungszeiten"}),e.jsx("input",{type:"text",value:o.hours,onChange:l=>p("hours",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Liefergebiet"}),e.jsx("input",{type:"text",value:o.area,onChange:l=>p("area",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"font-semibold border-b pb-2 flex items-center gap-2",children:[e.jsx(Ne,{size:18,className:"text-rose-500"})," Firmendaten (f√ºr Rechnungen)"]}),e.jsx("p",{className:"text-sm text-gray-500 -mt-2",children:"Diese Daten erscheinen auf allen Rechnungen und Quittungen."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Firmenname *"}),e.jsx("input",{type:"text",value:o.companyName,onChange:l=>p("companyName",l.target.value),placeholder:"z.B. Speeti GmbH",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Stra√üe + Hausnummer *"}),e.jsx("input",{type:"text",value:o.companyStreet,onChange:l=>p("companyStreet",l.target.value),placeholder:"z.B. Musterstra√üe 123",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"PLZ *"}),e.jsx("input",{type:"text",value:o.companyPostalCode,onChange:l=>p("companyPostalCode",l.target.value),placeholder:"48149",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Stadt *"}),e.jsx("input",{type:"text",value:o.companyCity,onChange:l=>p("companyCity",l.target.value),placeholder:"M√ºnster",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Telefon"}),e.jsx("input",{type:"text",value:o.companyPhone,onChange:l=>p("companyPhone",l.target.value),placeholder:"+49 251 123456",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"E-Mail"}),e.jsx("input",{type:"email",value:o.companyEmail,onChange:l=>p("companyEmail",l.target.value),placeholder:"info@speeti.de",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Website"}),e.jsx("input",{type:"text",value:o.companyWebsite,onChange:l=>p("companyWebsite",l.target.value),placeholder:"www.speeti.de",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"font-semibold border-b pb-2 flex items-center gap-2",children:[e.jsx(ls,{size:18,className:"text-rose-500"})," Steuerdaten"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Steuernummer *"}),e.jsx("input",{type:"text",value:o.taxNumber,onChange:l=>p("taxNumber",l.target.value),placeholder:"z.B. 123/456/78901",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"USt-IdNr."}),e.jsx("input",{type:"text",value:o.vatId,onChange:l=>p("vatId",l.target.value),placeholder:"z.B. DE123456789",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"MwSt. Lebensmittel (%)"}),e.jsx("input",{type:"number",value:o.taxRateFood,onChange:l=>p("taxRateFood",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"MwSt. Sonstiges (%)"}),e.jsx("input",{type:"number",value:o.taxRateOther,onChange:l=>p("taxRateOther",l.target.value),className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"font-semibold border-b pb-2 flex items-center gap-2",children:[e.jsx(fe,{size:18,className:"text-rose-500"})," Bankverbindung (f√ºr Rechnungen)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bank"}),e.jsx("input",{type:"text",value:o.bankName,onChange:l=>p("bankName",l.target.value),placeholder:"z.B. Sparkasse M√ºnsterland",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"IBAN"}),e.jsx("input",{type:"text",value:o.iban,onChange:l=>p("iban",l.target.value),placeholder:"DE89 3704 0044 0532 0130 00",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"BIC"}),e.jsx("input",{type:"text",value:o.bic,onChange:l=>p("bic",l.target.value),placeholder:"COBADEFFXXX",className:"w-full px-4 py-2 border rounded-xl focus:ring-2 focus:ring-rose-500 focus:outline-none"})]})]})]}),e.jsx("button",{onClick:Z,disabled:j,className:"w-full bg-rose-500 text-white py-4 rounded-xl hover:bg-rose-600 font-semibold disabled:bg-gray-300 flex items-center justify-center gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"})," Speichert..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{size:20})," Einstellungen speichern"]})})]})},He=()=>{const s=W.filter(r=>r.status==="open"),t=W.filter(r=>r.status==="closed"),n=async r=>{try{const{data:o}=await u.get(`/admin/support/${r}`);le(o.ticket),Te(o.messages)}catch(o){console.error(o)}},i=async()=>{if(!(!E.trim()||!b))try{await u.post(`/admin/support/${b.id}/reply`,{message:E}),re(""),n(b.id)}catch{alert("Fehler beim Senden")}},c=async r=>{try{await u.patch(`/admin/support/${r}/close`),le(null),y()}catch{alert("Fehler")}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Support-Tickets"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.length," offene Tickets, ",t.length," geschlossen"]})]}),e.jsx("button",{onClick:y,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(je,{size:18})})]}),R>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-center gap-3",children:[e.jsx(he,{className:"text-red-500",size:24}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-semibold text-red-800",children:[R," eskalierte Tickets"]}),e.jsx("p",{className:"text-sm text-red-600",children:"Diese Kunden wollen mit einem echten Mitarbeiter sprechen"})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("span",{className:"font-semibold",children:["Offene Tickets (",s.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-100 max-h-[500px] overflow-y-auto",children:s.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(ee,{size:40,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Keine offenen Tickets"})]}):s.map(r=>e.jsx("div",{onClick:()=>n(r.id),className:`p-4 cursor-pointer hover:bg-gray-50 transition-colors ${(b==null?void 0:b.id)===r.id?"bg-primary-50":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:["#",r.id]}),r.escalated?e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-100 text-red-700 font-medium",children:"üö® Eskaliert"}):e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 font-medium",children:"ü§ñ KI"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.user_name}),e.jsx("p",{className:"text-xs text-gray-400",children:r.user_email})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-400",children:new Date(r.created_at).toLocaleString("de-DE")}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.message_count," Nachrichten"]})]})]})},r.id))})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden flex flex-col",children:b?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-semibold",children:["Ticket #",b.id]}),b.escalated&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-100 text-red-700",children:"Eskaliert"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[b.user_name," ‚Ä¢ ",b.user_email]})]}),e.jsxs("button",{onClick:()=>c(b.id),className:"px-4 py-2 bg-green-500 text-white rounded-xl text-sm font-medium hover:bg-green-600 flex items-center gap-2",children:[e.jsx(Q,{size:16})," Schlie√üen"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 min-h-[300px] max-h-[400px] bg-gray-50",children:Pe.map((r,o)=>e.jsx("div",{className:`flex ${r.sender_type==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex items-end gap-2 max-w-[80%] ${r.sender_type==="user"?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center flex-shrink-0 ${r.sender_type==="user"?"bg-gray-600 text-white":r.sender_type==="admin"?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:r.sender_type==="user"?e.jsx(rs,{size:14}):r.sender_type==="admin"?e.jsx(ee,{size:14}):e.jsx(cs,{size:14})}),e.jsx("div",{className:`px-3 py-2 rounded-2xl text-sm ${r.sender_type==="user"?"bg-gray-600 text-white rounded-br-sm":r.sender_type==="admin"?"bg-blue-500 text-white rounded-bl-sm":"bg-white border border-gray-200 rounded-bl-sm"}`,children:r.message})]})},r.id||o))}),e.jsx("div",{className:"p-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:E,onChange:r=>re(r.target.value),onKeyDown:r=>r.key==="Enter"&&i(),placeholder:"Antwort schreiben...",className:"flex-1 px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500"}),e.jsx("button",{onClick:i,disabled:!E.trim(),className:"px-4 bg-primary-500 text-white rounded-xl hover:bg-primary-600 disabled:opacity-50",children:e.jsx(xs,{size:18})})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400 p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ms,{size:48,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"W√§hle ein Ticket aus"})]})})})]})]})},Ge=()=>{const[s,t]=x.useState(v||{name:"",slug:"",icon:"üì¶",color:"#14B8A6"}),n=async i=>{i.preventDefault(),v?await u.put(`/admin/categories/${v.id}`,{...s,active:1}):await u.post("/admin/categories",s),g(null),y()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(O.div,{initial:{scale:.95},animate:{scale:1},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:v?"Kategorie bearbeiten":"Neue Kategorie"}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:i=>t({...s,name:i.target.value,slug:i.target.value.toLowerCase().replace(/[√§√∂√º√ü\s]/g,c=>({√§:"ae",√∂:"oe",√º:"ue",√ü:"ss"," ":"-"})[c]||c)}),required:!0,className:"w-full px-4 py-2 border rounded-xl"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Icon (Emoji)"}),e.jsx("input",{type:"text",value:s.icon,onChange:i=>t({...s,icon:i.target.value}),className:"w-full px-4 py-2 border rounded-xl text-2xl text-center"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Farbe"}),e.jsx("input",{type:"color",value:s.color,onChange:i=>t({...s,color:i.target.value}),className:"w-full h-10 border rounded-xl cursor-pointer"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>g(null),className:"flex-1 py-2 border rounded-xl",children:"Abbrechen"}),e.jsx("button",{type:"submit",className:"flex-1 py-2 bg-primary-500 text-white rounded-xl",children:"Speichern"})]})]})]})})},Ve=()=>{const[s,t]=x.useState({name:"",email:"",phone:"",password:""}),n=async i=>{i.preventDefault(),await u.post("/admin/drivers",s),g(null),y()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(O.div,{initial:{scale:.95},animate:{scale:1},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Neuer Fahrer"}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:i=>t({...s,name:i.target.value}),required:!0,className:"w-full px-4 py-2 border rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"E-Mail"}),e.jsx("input",{type:"email",value:s.email,onChange:i=>t({...s,email:i.target.value}),required:!0,className:"w-full px-4 py-2 border rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Telefon"}),e.jsx("input",{type:"tel",value:s.phone,onChange:i=>t({...s,phone:i.target.value}),className:"w-full px-4 py-2 border rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Passwort"}),e.jsx("input",{type:"password",value:s.password,onChange:i=>t({...s,password:i.target.value}),required:!0,minLength:6,className:"w-full px-4 py-2 border rounded-xl"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>g(null),className:"flex-1 py-2 border rounded-xl",children:"Abbrechen"}),e.jsx("button",{type:"submit",className:"flex-1 py-2 bg-primary-500 text-white rounded-xl",children:"Anlegen"})]})]})]})})},We=()=>{var n,i;if(!d)return null;const s=M[d.status]||M.pending,t=()=>{var o;const c=`
        <html>
        <head>
          <title>Bestellung #${d.id}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; max-width: 400px; margin: 0 auto; }
            h1 { font-size: 18px; border-bottom: 2px solid #000; padding-bottom: 10px; }
            .info { margin: 10px 0; }
            .items { margin: 20px 0; }
            .item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed #ccc; }
            .total { font-weight: bold; font-size: 18px; margin-top: 15px; padding-top: 10px; border-top: 2px solid #000; }
            .address { background: #f5f5f5; padding: 10px; margin: 10px 0; }
          </style>
        </head>
        <body>
          <h1>Speeti - Bestellung #${d.id}</h1>
          <div class="info">
            <strong>Kunde:</strong> ${d.customer_name}<br>
            <strong>Tel:</strong> ${d.customer_phone||"-"}<br>
            <strong>Zeit:</strong> ${new Date(d.created_at).toLocaleString("de-DE")}
          </div>
          <div class="address">
            <strong>Lieferadresse:</strong><br>
            ${d.street} ${d.house_number}<br>
            ${d.postal_code} ${d.city}
            ${d.instructions?"<br><em>Hinweis: "+d.instructions+"</em>":""}
          </div>
          <div class="items">
            <strong>Artikel:</strong>
            ${(d.items||[]).map(a=>'<div class="item"><span>'+a.quantity+"x "+a.name+"</span><span>"+(a.price*a.quantity).toFixed(2)+" EUR</span></div>").join("")}
          </div>
          <div class="total">
            Gesamt: ${(o=d.total)==null?void 0:o.toFixed(2)} EUR
          </div>
          <p style="margin-top:20px;font-size:12px;color:#666">Vielen Dank!</p>
        </body>
        </html>
      `,r=window.open("","_blank");r.document.write(c),r.document.close(),r.print()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(O.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:`p-4 flex items-center justify-between ${s.bg}`,children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold",children:["Bestellung #",d.id]}),e.jsx("span",{className:`text-sm ${s.text}`,children:s.label})]}),e.jsx("button",{onClick:()=>L(null),className:"p-2 hover:bg-white/20 rounded-full",children:e.jsx(be,{size:20})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto flex-1 space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-600 mb-2",children:"Kunde"}),e.jsx("p",{className:"font-medium",children:d.customer_name}),d.customer_phone&&e.jsxs("a",{href:`tel:${d.customer_phone}`,className:"text-primary-600 text-sm flex items-center gap-1 mt-1",children:[e.jsx(ge,{size:14})," ",d.customer_phone]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-600 mb-2",children:"Lieferadresse"}),e.jsxs("p",{className:"font-medium",children:[d.street," ",d.house_number]}),e.jsxs("p",{className:"text-gray-600",children:[d.postal_code," ",d.city]}),d.instructions&&e.jsx("p",{className:"text-sm text-primary-600 mt-2 bg-primary-50 p-2 rounded-lg",children:d.instructions})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsxs("h3",{className:"font-semibold text-sm text-gray-600 mb-2",children:["Artikel (",((n=d.items)==null?void 0:n.length)||0,")"]}),e.jsx("div",{className:"space-y-2",children:(d.items||[]).map((c,r)=>{var o;return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-200 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[c.image&&e.jsx("img",{src:c.image,alt:"",className:"w-10 h-10 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:c.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[c.quantity,"x ",(o=c.price)==null?void 0:o.toFixed(2),"‚Ç¨"]})]})]}),e.jsxs("span",{className:"font-semibold",children:[(c.price*c.quantity).toFixed(2),"‚Ç¨"]})]},r)})})]}),e.jsxs("div",{className:"bg-primary-50 rounded-xl p-3 flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-primary-800",children:"Gesamtsumme"}),e.jsxs("span",{className:"text-xl font-bold text-primary-600",children:[(i=d.total)==null?void 0:i.toFixed(2),"‚Ç¨"]})]}),d.notes&&e.jsxs("div",{className:"bg-yellow-50 rounded-xl p-3",children:[e.jsx("h3",{className:"font-semibold text-sm text-yellow-700 mb-1",children:"Anmerkungen"}),e.jsx("p",{className:"text-sm text-yellow-800",children:d.notes})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-100 flex gap-2",children:[e.jsxs("button",{onClick:t,className:"flex-1 flex items-center justify-center gap-2 py-2.5 border border-gray-200 rounded-xl hover:bg-gray-50",children:[e.jsx(ye,{size:18})," Drucken"]}),e.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(d.street+" "+d.house_number+", "+d.postal_code+" "+d.city)}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center justify-center gap-2 py-2.5 bg-primary-500 text-white rounded-xl hover:bg-primary-600",children:[e.jsx(X,{size:18})," Maps"]})]})]})})};return e.jsxs("div",{className:"min-h-screen bg-gray-100 flex",children:[e.jsxs("aside",{className:`fixed lg:static inset-y-0 left-0 z-40 bg-white border-r border-gray-200 transition-all ${S?"w-16":"w-64"} hidden lg:block`,children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-500 to-teal-500 rounded-xl flex items-center justify-center text-white font-bold text-lg",children:"‚ö°"}),!S&&e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-gray-900",children:"Speeti"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Admin Panel"})]})]})}),e.jsx("nav",{className:"p-2 space-y-1",children:we.map(s=>e.jsxs("button",{onClick:()=>s.external?F(s.external):P(s.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-left transition-colors ${f===s.id?"bg-primary-50 text-primary-700":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(s.icon,{size:20}),!S&&e.jsx("span",{className:"font-medium text-sm flex-1",children:s.label}),s.badge&&xe>0&&!S&&e.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:xe}),s.supportBadge&&R>0&&!S&&e.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full animate-pulse",children:R}),s.external&&!S&&e.jsx(X,{size:14,className:"text-gray-400"})]},s.id))}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-2 border-t border-gray-100 bg-white",children:e.jsxs("button",{onClick:()=>{se(),F("/login")},className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-left transition-colors text-red-600 hover:bg-red-50",children:[e.jsx(pe,{size:20}),!S&&e.jsx("span",{className:"font-medium text-sm",children:"Abmelden"})]})})]}),e.jsx("header",{className:"lg:hidden fixed top-0 left-0 right-0 bg-white border-b border-gray-200 p-3 z-30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"font-bold",children:"‚ö° Speeti Admin"}),e.jsx("select",{value:f,onChange:s=>P(s.target.value),className:"px-3 py-1.5 border rounded-lg text-sm",children:we.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))}),e.jsx("button",{onClick:()=>{se(),F("/login")},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Abmelden",children:e.jsx(pe,{size:20})})]})}),e.jsx("main",{className:"flex-1 p-4 lg:p-6 pt-16 lg:pt-6 overflow-auto",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[f==="dashboard"&&e.jsx(De,{}),f==="orders"&&e.jsx(Le,{}),f==="products"&&Re,f==="categories"&&e.jsx(Ke,{}),f==="drivers"&&e.jsx(Ie,{}),f==="customers"&&e.jsx(Oe,{}),f==="support"&&e.jsx(He,{}),f==="analytics"&&e.jsx("div",{className:"text-center py-12 text-gray-400",children:"üìä Statistiken kommen bald"}),f==="settings"&&e.jsx(Ue,{})]})}),e.jsxs(es,{children:[G==="product"&&e.jsx(qe,{}),G==="category"&&e.jsx(Ge,{}),G==="driver"&&e.jsx(Ve,{}),d&&e.jsx(We,{})]})]})}export{Ps as default};
