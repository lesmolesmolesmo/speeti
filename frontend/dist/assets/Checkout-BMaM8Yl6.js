const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddressMap-BYsasyjY.js","assets/index-TnPH2S_w.js","assets/index-B9zXfgxB.css","assets/mapbox-gl-CbJENOAs.js","assets/navigation-BMvs7t9G.js"])))=>i.map(i=>d[i]);
import{c as A,r as a,j as e,S as je,X as de,M as q,u as ye,a as Ne,b as ve,A as D,L as te,d as we,C as re,Z as ae,m as ne,e as W,P as ke,f as ze,g as le,_ as Se}from"./index-TnPH2S_w.js";import{T as ie}from"./tag-DZDAfEXw.js";/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=A("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=A("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=A("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=A("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=A("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),$e="pk.eyJ1Ijoic3BlZXRpc3BlZXRpIiwiYSI6ImNtbDZ6dHJ4ZzAyZzczY3NpeDdhNHE4aWYifQ.WiNxZwRzk9aPGN9DrjyT3Q",Le=a.memo(function({value:h,onChange:x,onSelect:g,placeholder:C="StraÃŸe suchen...",className:b=""}){const[p,v]=a.useState(h||""),[w,j]=a.useState([]),[i,r]=a.useState(!1),[y,l]=a.useState(!1),S=a.useRef(null),N=a.useRef(null);a.useEffect(()=>{h!==void 0&&h!==p&&v(h)},[h]),a.useEffect(()=>{if(!p||p.length<3){j([]);return}const t=setTimeout(async()=>{r(!0);try{const Z=((await(await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(p+" MÃ¼nster Deutschland")}.json?access_token=${$e}&language=de&country=de&bbox=7.45,51.85,7.80,52.08&types=address&limit=5`)).json()).features||[]).map(f=>{const m=f.context||[];let d="",L="MÃ¼nster";return m.forEach(o=>{o.id.startsWith("postcode")&&(d=o.text),o.id.startsWith("place")&&(L=o.text)}),{id:f.id,street:f.text||"",houseNumber:f.address||"",postalCode:d,city:L,fullAddress:f.place_name,lng:f.center[0],lat:f.center[1]}}).filter(f=>f.postalCode.startsWith("48"));j(Z),l(Z.length>0)}catch(c){console.error("Address search error:",c)}finally{r(!1)}},300);return()=>clearTimeout(t)},[p]),a.useEffect(()=>{const t=c=>{N.current&&!N.current.contains(c.target)&&l(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const R=t=>{const c=t.target.value;v(c),x==null||x(c),l(!0)},H=t=>{v(t.street),l(!1),g==null||g(t)},$=()=>{var t;v(""),x==null||x(""),j([]),(t=S.current)==null||t.focus()};return e.jsxs("div",{ref:N,className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx(je,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{ref:S,type:"text",value:p,onChange:R,onFocus:()=>w.length>0&&l(!0),placeholder:C,className:`w-full pl-10 pr-10 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-rose-500 ${b}`}),p&&e.jsx("button",{type:"button",onClick:$,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(de,{size:18})}),i&&e.jsx("div",{className:"absolute right-10 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"w-4 h-4 border-2 border-rose-500/30 border-t-rose-500 rounded-full animate-spin"})})]}),y&&w.length>0&&e.jsx("div",{className:"absolute left-0 right-0 mt-1 bg-white border border-gray-200 rounded-xl shadow-xl overflow-hidden z-50",children:w.map(t=>e.jsxs("button",{type:"button",onClick:()=>H(t),className:"w-full flex items-start gap-3 p-3 hover:bg-rose-50 active:bg-rose-100 border-b border-gray-100 last:border-0 text-left transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-rose-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx(q,{size:16,className:"text-rose-500"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-900 text-sm",children:[t.street," ",t.houseNumber]}),e.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[t.postalCode," ",t.city]})]})]},t.id))})]})}),Pe=a.lazy(()=>Se(()=>import("./AddressMap-BYsasyjY.js"),__vite__mapDeps([0,1,2,3,4]))),Ze=(z="08:00",h="22:00")=>{const x=[],g=new Date,C=g.getHours(),b=g.getMinutes(),[p]=z.split(":").map(Number),[v]=h.split(":").map(Number);let w=Math.max(C+1,p);if(b>=30&&(w=C+1),w<v)for(let i=w;i<v;i++)for(let r=0;r<60;r+=30){if(i===C&&r<=b)continue;const y=`${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`,l=r===30?i+1:i,S=r===30?"00":"30",N=`${l.toString().padStart(2,"0")}:${S}`;x.push({id:`today-${y}`,label:`Heute ${y} - ${N}`,date:"today",time:y,datetime:new Date(g.getFullYear(),g.getMonth(),g.getDate(),i,r).toISOString()})}const j=new Date(g);j.setDate(j.getDate()+1);for(let i=p;i<v;i++)for(let r=0;r<60;r+=30){const y=`${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`,l=r===30?i+1:i,S=r===30?"00":"30",N=`${l.toString().padStart(2,"0")}:${S}`;x.push({id:`tomorrow-${y}`,label:`Morgen ${y} - ${N}`,date:"tomorrow",time:y,datetime:new Date(j.getFullYear(),j.getMonth(),j.getDate(),i,r).toISOString()})}return x},O=z=>{const h=z.replace(/\s/g,"");return h.length===5&&h.startsWith("48")},Ee=({method:z})=>{switch(z){case"cash":return e.jsx(_e,{size:24});case"card":return e.jsx(ce,{size:24});case"stripe":return e.jsx(ce,{size:24});default:return e.jsx(Me,{size:24})}},Ae=[{id:"cash",name:"Bar bei Lieferung",description:"Barzahlung an der TÃ¼r",online:!1},{id:"card",name:"Karte bei Lieferung",description:"EC/Kreditkarte an der TÃ¼r",online:!1},{id:"stripe",name:"Online bezahlen",description:"Kreditkarte, PayPal, Klarna & mehr",online:!0,badge:"Empfohlen"}];function Fe(){var ee;const z=ye(),[h]=Ne(),{cart:x,getCartTotal:g,addresses:C,selectedAddress:b,fetchAddresses:p,selectAddress:v,addAddress:w,createOrder:j,clearCart:i,shopStatus:r,fetchShopStatus:y}=ve(),[l,S]=a.useState("stripe"),[N,R]=a.useState(""),[H,$]=a.useState(!1),[t,c]=a.useState({street:"",house_number:"",postal_code:"",instructions:""}),[K,Z]=a.useState(!1),[f,m]=a.useState(null),[d,L]=a.useState("asap"),[o,U]=a.useState(null),[xe,B]=a.useState(!1),[T,V]=a.useState(""),[Y,X]=a.useState(!1),[n,G]=a.useState(null),[me,I]=a.useState(!1),J=Ze(r==null?void 0:r.openingTime,r==null?void 0:r.closingTime),u=(r==null?void 0:r.open)??!0;a.useEffect(()=>{!u&&d==="asap"&&(r==null?void 0:r.open)!==void 0&&L("scheduled")},[u]);const _=g(),Q=_>=20?0:2.99;let P=0;n&&(n.discount_type==="percent"?P=_*(n.discount_value/100):n.discount_type==="fixed"?P=Math.min(n.discount_value,_):n.discount_type==="delivery"&&(P=Q));const F=(n==null?void 0:n.discount_type)==="delivery"?0:Q,ue=Math.max(0,_-P+F);a.useEffect(()=>{p(),y(),h.get("cancelled")==="true"&&m("Zahlung abgebrochen. Bitte versuche es erneut.")},[]);const he=async()=>{var s,E;if(T.trim()){X(!0),m(null);try{const{data:k}=await le.post("/promo/validate",{code:T.trim(),subtotal:_});k.valid&&(G(k.promo),V(""))}catch(k){m(((E=(s=k.response)==null?void 0:s.data)==null?void 0:E.error)||"UngÃ¼ltiger Promo-Code")}finally{X(!1)}}},ge=()=>{G(null)},be=async()=>{if(!t.street||!t.house_number||!t.postal_code){m("Bitte fÃ¼lle alle Pflichtfelder aus");return}if(!O(t.postal_code)){m("Wir liefern derzeit nur nach MÃ¼nster (PLZ 48xxx). Bitte gib eine gÃ¼ltige MÃ¼nsteraner Postleitzahl ein.");return}await w({...t,city:"MÃ¼nster",is_default:!0}),$(!1),c({street:"",house_number:"",postal_code:"",instructions:""})},pe=async s=>{I(!1),c({street:s.street||"",house_number:s.house_number||"",postal_code:s.postal_code||"",instructions:""}),s.street&&s.house_number&&s.postal_code?await w({...s,city:"MÃ¼nster",is_default:!0,label:`${s.street} ${s.house_number}`}):$(!0)},fe=async()=>{var s,E;if(!b){m("Bitte wÃ¤hle eine Lieferadresse");return}if(d==="scheduled"&&!o){m("Bitte wÃ¤hle eine Lieferzeit aus");return}if(!u&&d==="asap"&&(r==null?void 0:r.open)!==void 0){m("Der Shop ist geschlossen. Bitte wÃ¤hle eine Vorbestellzeit.");return}Z(!0),m(null);try{const k=x.map(M=>({product_id:M.id,quantity:M.quantity})),se=d==="scheduled"&&o?o.datetime:null;if(l==="stripe"){const{data:M}=await le.post("/checkout/create-session",{address_id:b.id,items:k,notes:N,scheduled_time:se});if(M.url)window.location.href=M.url;else throw new Error("Keine Checkout-URL erhalten")}else{const M=await j(b.id,l,N,se);z(`/orders/${M.id}`)}}catch(k){console.error("Order error:",k),m(((E=(s=k.response)==null?void 0:s.data)==null?void 0:E.error)||"Fehler bei der Bestellung. Bitte versuche es erneut."),Z(!1)}};return x.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(D,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Warenkorb ist leer"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"FÃ¼ge Artikel hinzu, um zu bestellen."}),e.jsx(te,{to:"/",className:"text-rose-500 font-medium",children:"Zum Shop â†’"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-36",children:[e.jsx("header",{className:"bg-white sticky top-0 z-40 border-b border-gray-100",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-4 flex items-center gap-4",children:[e.jsx(te,{to:"/cart",className:"p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(we,{size:24})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Kasse"})]})}),!u&&e.jsx("div",{className:"bg-amber-50 border-b border-amber-100 px-4 py-3",children:e.jsxs("div",{className:"max-w-lg mx-auto flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(re,{size:20,className:"text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-amber-800",children:"Shop aktuell geschlossen"}),e.jsxs("p",{className:"text-sm text-amber-700",children:["Ã–ffnet um ",(r==null?void 0:r.openingTime)||"08:00"," Uhr. Du kannst jetzt vorbestellen!"]})]})]})}),f&&e.jsx("div",{className:"bg-red-50 border-b border-red-100 px-4 py-3",children:e.jsxs("div",{className:"max-w-lg mx-auto flex items-center gap-2 text-red-700",children:[e.jsx(D,{size:18}),e.jsx("span",{className:"text-sm",children:f}),e.jsx("button",{onClick:()=>m(null),className:"ml-auto text-red-500",children:"âœ•"})]})}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6 space-y-6",children:[e.jsxs("section",{className:"bg-white rounded-2xl p-4",children:[e.jsxs("h2",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(re,{size:20,className:"text-rose-500"})," Lieferzeit"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("button",{onClick:()=>{u&&(L("asap"),U(null))},disabled:!u,className:`p-4 rounded-xl border-2 transition-all relative ${u?d==="asap"?"border-rose-500 bg-rose-50":"border-gray-200 hover:border-gray-300":"border-gray-200 bg-gray-50 cursor-not-allowed opacity-60"}`,children:[!u&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-amber-500 text-white text-[10px] px-2 py-0.5 rounded-full font-medium",children:"Geschlossen"}),e.jsx(ae,{className:`mx-auto mb-2 ${u?d==="asap"?"text-rose-500":"text-gray-400":"text-gray-300"}`,size:24}),e.jsx("p",{className:`font-semibold text-sm ${u?"":"text-gray-400"}`,children:"SchnellstmÃ¶glich"}),e.jsx("p",{className:`text-xs ${u?"text-gray-500":"text-gray-400"}`,children:u?"15-20 Minuten":"Nicht verfÃ¼gbar"})]}),e.jsxs("button",{onClick:()=>B(!0),className:`p-4 rounded-xl border-2 transition-all ${d==="scheduled"?"border-rose-500 bg-rose-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(oe,{className:`mx-auto mb-2 ${d==="scheduled"?"text-rose-500":"text-gray-400"}`,size:24}),e.jsx("p",{className:"font-semibold text-sm",children:"Vorbestellen"}),e.jsx("p",{className:"text-xs text-gray-500",children:o?o.label:"Zeit wÃ¤hlen"})]})]}),d==="asap"&&u?e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-xl",children:[e.jsx(ae,{className:"text-green-600",size:20}),e.jsxs("p",{className:"text-sm text-green-700",children:["Lieferung in ",e.jsx("strong",{children:"15-20 Minuten"})]})]}):d==="scheduled"&&o?e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-rose-50 rounded-xl",children:[e.jsx(oe,{className:"text-rose-500",size:20}),e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"text-sm text-rose-700",children:["Lieferung: ",e.jsx("strong",{children:o.label})]})}),e.jsx("button",{onClick:()=>B(!0),className:"text-rose-600 text-sm font-medium hover:underline",children:"Ã„ndern"})]}):d==="scheduled"&&!o?e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-amber-50 rounded-xl",children:[e.jsx(D,{className:"text-amber-500",size:20}),e.jsx("p",{className:"text-sm text-amber-700",children:"Bitte wÃ¤hle eine Lieferzeit aus"})]}):null]}),xe&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-end",children:e.jsxs(ne.div,{initial:{y:"100%"},animate:{y:0},className:"bg-white w-full rounded-t-3xl max-h-[70vh] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Lieferzeit wÃ¤hlen"}),e.jsx("button",{onClick:()=>B(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(de,{size:20})})]}),e.jsx("div",{className:"p-4 overflow-y-auto max-h-[50vh] pb-20",children:J.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D,{className:"mx-auto text-gray-400 mb-3",size:40}),e.jsx("p",{className:"text-gray-600",children:"Keine Zeitfenster verfÃ¼gbar"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Bitte versuche es morgen erneut"})]}):e.jsx("div",{className:"space-y-2",children:J.map(s=>e.jsx("button",{onClick:()=>{U(s),L("scheduled"),B(!1)},className:`w-full p-4 rounded-xl border-2 text-left transition-colors ${(o==null?void 0:o.id)===s.id?"border-rose-500 bg-rose-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsx("p",{className:"font-medium",children:s.label})},s.id))})})]})}),e.jsx("section",{className:"bg-gradient-to-r from-rose-50 to-pink-50 border border-rose-100 rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-rose-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(q,{size:20,className:"text-rose-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Liefergebiet: MÃ¼nster"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Wir liefern aktuell nur innerhalb von MÃ¼nster (PLZ 48xxx). Lieferzeit: 15-20 Minuten ðŸš´"})]})]})}),e.jsxs("section",{className:"bg-white rounded-2xl p-4",children:[e.jsxs("h2",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(q,{size:20,className:"text-rose-500"})," Lieferadresse auswÃ¤hlen"]}),C.map(s=>e.jsxs("button",{onClick:()=>v(s),className:`w-full text-left p-3 rounded-xl mb-2 border-2 transition-colors ${(b==null?void 0:b.id)===s.id?"border-rose-500 bg-rose-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.label}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.street," ",s.house_number]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.postal_code," ",s.city]})]},s.id)),e.jsxs("button",{onClick:()=>I(!0),className:"w-full flex items-center gap-3 p-4 mb-3 bg-gradient-to-r from-rose-50 to-pink-50 border-2 border-rose-200 rounded-xl hover:border-rose-400 transition-colors",children:[e.jsx("div",{className:"w-12 h-12 bg-rose-100 rounded-xl flex items-center justify-center",children:e.jsx(Ce,{size:24,className:"text-rose-500"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"ðŸ“ Auf Karte auswÃ¤hlen"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Standort direkt auf der Karte markieren"})]}),e.jsx(W,{size:20,className:"text-rose-400"})]}),H?e.jsxs(ne.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"space-y-3 pt-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["StraÃŸe * ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(tippen zum Suchen)"})]}),e.jsx(Le,{value:t.street,onChange:s=>c({...t,street:s}),onSelect:s=>{c({...t,street:s.street,house_number:s.houseNumber||t.house_number,postal_code:s.postalCode||t.postal_code,lat:s.lat,lng:s.lng})},placeholder:"z.B. Hammer StraÃŸe..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"w-1/3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hausnr. *"}),e.jsx("input",{type:"text",placeholder:"12a",value:t.house_number,onChange:s=>c({...t,house_number:s.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-rose-500"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PLZ (MÃ¼nster) *"}),e.jsx("input",{type:"text",placeholder:"48xxx",maxLength:5,value:t.postal_code,onChange:s=>c({...t,postal_code:s.target.value.replace(/\D/g,"").slice(0,5)}),className:`w-full p-3 border rounded-xl focus:outline-none focus:ring-2 ${t.postal_code&&!O(t.postal_code)?"border-red-300 focus:ring-red-500 bg-red-50":"border-gray-200 focus:ring-rose-500"}`}),t.postal_code&&!O(t.postal_code)&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"âš ï¸ Nur PLZ 48xxx (MÃ¼nster)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stadt"}),e.jsx("input",{type:"text",value:"MÃ¼nster",disabled:!0,className:"w-full p-3 border border-gray-200 rounded-xl bg-gray-100 text-gray-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["ðŸ“ Hinweise fÃ¼r Fahrer ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(optional)"})]}),e.jsx("textarea",{placeholder:"z.B. 3. Stock, Hinterhaus, Klingel defekt - bitte anrufen...",value:t.instructions,onChange:s=>c({...t,instructions:s.target.value}),rows:2,className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-rose-500 resize-none"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>$(!1),className:"flex-1 py-3 border border-gray-200 rounded-xl text-gray-600 hover:bg-gray-50",children:"Abbrechen"}),e.jsx("button",{onClick:be,className:"flex-1 py-3 bg-rose-500 text-white rounded-xl font-medium hover:bg-rose-600",children:"Speichern"})]})]}):e.jsxs("button",{onClick:()=>$(!0),className:"w-full flex items-center justify-center gap-2 p-3 border-2 border-dashed border-gray-300 rounded-xl text-gray-500 hover:border-rose-500 hover:text-rose-500 transition-colors",children:[e.jsx(ke,{size:20})," Neue Adresse"]})]}),e.jsxs("section",{className:"bg-white rounded-2xl p-4",children:[e.jsx("h2",{className:"font-semibold text-gray-900 mb-4",children:"Zahlungsart"}),e.jsx("div",{className:"space-y-3",children:Ae.map(s=>e.jsxs("button",{onClick:()=>S(s.id),className:`w-full flex items-center gap-3 p-4 rounded-xl border-2 transition-colors ${l===s.id?"border-rose-500 bg-rose-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${l===s.id?"bg-rose-100 text-rose-500":"bg-gray-100 text-gray-400"}`,children:e.jsx(Ee,{method:s.id})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.name}),s.badge&&e.jsx("span",{className:"text-[10px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-medium",children:s.badge})]}),e.jsx("p",{className:"text-xs text-gray-500",children:s.description})]}),e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${l===s.id?"border-rose-500 bg-rose-500":"border-gray-300"}`,children:l===s.id&&e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]},s.id))}),l==="stripe"&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-xl",children:e.jsx("p",{className:"text-sm text-blue-700",children:"ðŸ’³ Du wirst zu unserem sicheren Zahlungsanbieter weitergeleitet."})})]}),e.jsxs("section",{className:"bg-white rounded-2xl p-4",children:[e.jsxs("h2",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ie,{size:18,className:"text-rose-500"})," Promo-Code"]}),n?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(ze,{size:20,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-800",children:n.code}),e.jsx("p",{className:"text-xs text-green-600",children:n.description})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-green-600",children:["-",(ee=n.discount_amount)==null?void 0:ee.toFixed(2)," â‚¬"]}),e.jsx("button",{onClick:ge,className:"text-xs text-red-500 hover:underline",children:"Entfernen"})]})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:T,onChange:s=>V(s.target.value.toUpperCase()),placeholder:"Code eingeben",className:"flex-1 p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-rose-500 uppercase"}),e.jsx("button",{onClick:he,disabled:!T.trim()||Y,className:"px-4 bg-rose-500 text-white rounded-xl font-medium hover:bg-rose-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:Y?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):"EinlÃ¶sen"})]}),!n&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["ðŸ’¡ Probiere: ",e.jsx("span",{className:"font-mono bg-gray-100 px-1 rounded",children:"WELCOME10"})," fÃ¼r 10% Rabatt"]})]}),e.jsxs("section",{className:"bg-white rounded-2xl p-4",children:[e.jsx("h2",{className:"font-semibold text-gray-900 mb-3",children:"Anmerkungen"}),e.jsx("textarea",{value:N,onChange:s=>R(s.target.value),placeholder:"Besondere WÃ¼nsche oder Hinweise fÃ¼r den Fahrer...",rows:2,className:"w-full p-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-rose-500 resize-none"})]}),e.jsxs("section",{className:"bg-white rounded-2xl p-4",children:[e.jsx("h2",{className:"font-semibold text-gray-900 mb-3",children:"BestellÃ¼bersicht"}),x.map(s=>e.jsxs("div",{className:"flex justify-between py-2 text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[s.quantity,"x ",s.name]}),e.jsxs("span",{className:"font-medium",children:[(s.price*s.quantity).toFixed(2)," â‚¬"]})]},s.id)),e.jsxs("div",{className:"border-t border-gray-100 mt-2 pt-2 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Zwischensumme"}),e.jsxs("span",{children:[_.toFixed(2)," â‚¬"]})]}),P>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{size:14})," Rabatt (",n==null?void 0:n.code,")"]}),e.jsxs("span",{children:["-",P.toFixed(2)," â‚¬"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Lieferung"}),e.jsx("span",{children:(n==null?void 0:n.discount_type)==="delivery"?e.jsx("span",{className:"text-green-600",children:"Kostenlos ðŸŽ‰"}):F>0?`${F.toFixed(2)} â‚¬`:e.jsx("span",{className:"text-green-600",children:"Kostenlos"})})]}),F>0&&_<20&&!n&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Noch ",(20-_).toFixed(2)," â‚¬ fÃ¼r kostenlose Lieferung"]})]})]})]}),me&&e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8",children:[e.jsx("div",{className:"w-10 h-10 border-3 border-rose-500/30 border-t-rose-500 rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Karte wird geladen..."})]})}),children:e.jsx(Pe,{onAddressSelect:pe,onClose:()=>I(!1)})}),e.jsx("div",{className:"fixed bottom-16 lg:bottom-0 left-0 right-0 bg-white border-t border-gray-200 safe-bottom z-30",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex justify-between mb-3",children:[e.jsx("span",{className:"text-gray-600",children:"Gesamtsumme"}),e.jsxs("span",{className:"font-bold text-xl",children:[ue.toFixed(2)," â‚¬"]})]}),e.jsx("button",{onClick:fe,disabled:!b||K||d==="scheduled"&&!o,className:"w-full bg-rose-500 hover:bg-rose-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold py-4 rounded-2xl transition-colors shadow-lg shadow-rose-500/30 flex items-center justify-center gap-2",children:K?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):l==="stripe"?e.jsxs(e.Fragment,{children:["Zur Zahlung ",e.jsx(W,{size:20})]}):e.jsxs(e.Fragment,{children:["Jetzt bestellen ",e.jsx(W,{size:20})]})}),l==="stripe"&&e.jsx("p",{className:"text-xs text-center text-gray-400 mt-2",children:"Sichere Zahlung Ã¼ber Stripe"})]})})]})}export{Fe as default};
